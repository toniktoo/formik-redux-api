(this["webpackJsonpform-example-auth"]=this["webpackJsonpform-example-auth"]||[]).push([[0],{141:function(e,t,a){e.exports=a(221)},147:function(e,t,a){},221:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),i=a(28),s=a.n(i),c=(a(146),a(147),a(40)),u=a(11),l=a(122),m=a(27),d=a(25),p=a(6),b=a(225),h=function(e,t){return localStorage.setItem(e,t)},E=function(e){return localStorage.removeItem(e)},f=a(226),g=Object(f.a)("USER_SIGNUP_REQUEST"),O=Object(f.a)("USER_SIGNUP_SUCCESS"),j=Object(f.a)("USER_SIGNUP_FAILURE"),v=Object(f.a)("USER_AUTH_REQUEST"),w=Object(f.a)("USER_AUTH_SUCCESS"),L=Object(f.a)("USER_AUTH_FAILURE"),A=Object(f.a)("LOG_OUT_PROFILE"),S={name:"",token:void 0,isLoading:!1,isAuth:!1},k=Object(b.a)((n={},Object(d.a)(n,g,(function(e,t){var a=t.payload.isLoading;return Object(p.a)(Object(p.a)({},e),{},{isLoading:a})})),Object(d.a)(n,O,(function(e,t){var a=t.payload,n=a.isAuth,r=a.token,o=a.name,i=a.isLoading;return h("token",r),h("name",o),Object(p.a)(Object(p.a)({},e),{},{isAuth:n,token:r,name:o,isLoading:i})})),Object(d.a)(n,j,(function(e,t){var a=t.payload,n=a.isAuth,r=a.isLoading,o=a.setFieldError,i=a.error;"Network Error"===i.message&&alert(i.message);var s=i.response.data.errors;for(var c in s)o(c.toString(),s[c][0]);return Object(p.a)(Object(p.a)({},e),{},{isAuth:n,isLoading:r})})),Object(d.a)(n,v,(function(e,t){var a=t.payload.isLoading;return Object(p.a)(Object(p.a)({},e),{},{isLoading:a})})),Object(d.a)(n,w,(function(e,t){var a=t.payload,n=a.isAuth,r=a.token,o=a.name,i=a.isLoading;return h("token",r),h("name",o),Object(p.a)(Object(p.a)({},e),{},{isAuth:n,token:r,name:o,isLoading:i})})),Object(d.a)(n,L,(function(e,t){var a=t.payload,n=a.isAuth,r=a.isLoading,o=a.setFieldError,i=a.error;return"Network Error"===i.message&&alert(i.message),i.response.data.errors["email or password"]&&(o("email","email or password is invalid"),o("password","email or password is invalid")),Object(p.a)(Object(p.a)({},e),{},{isAuth:n,isLoading:r})})),Object(d.a)(n,A,(function(e,t){var a=t.payload,n=a.isAuth,r=a.token,o=a.name;return E("token"),E("name"),Object(p.a)(Object(p.a)({},e),{},{name:o,isAuth:n,token:r})})),n),S),N=Object(c.c)({authReducer:k}),R=a(4),_=a(23),y=a.n(_),x=a(46),U=a(30),F=a(33),I=a(64),T=a(224),P=function(e){var t=e.name,a=Object(I.a)(e,["name"]);return o.a.createElement("div",{className:"formFieldWrap"},o.a.createElement(T.a,Object.assign({name:t},a,{className:"formField"})),o.a.createElement(U.a,{name:t,className:"formFieldError"},(function(e){return function(e){return o.a.createElement("span",{className:"errorMsg"},e)}(e)})))},C=a(99),q=a.n(C),D="https://conduit.productionready.io/api/users",G={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},json:!0},J=function(){var e=Object(x.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q()(Object(p.a)(Object(p.a)({},G),{},{data:JSON.stringify(t),url:D}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(x.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q()(Object(p.a)(Object(p.a)({},G),{},{data:JSON.stringify(t),url:"".concat(D,"/login")}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=F.a().shape({email:F.b().email("Not correct email").required("Enter email"),password:F.b().required("Enter password")}),H=Object(U.d)({mapPropsToValues:function(){return{email:"",password:""}},validationSchema:function(){return X},handleSubmit:function(e,t){var a=e.email,n=e.password,r=t.props,o=t.setFieldError;r.signInAuth({email:a,password:n,setFieldError:o})},displayName:"signInAuth"})((function(e){var t=e.isLoading,a=e.handleSubmit;return t?"Loading...":o.a.createElement("form",{onSubmit:a,className:"form"},o.a.createElement("div",null,o.a.createElement("h2",{className:"title"},"Login"),o.a.createElement("hr",{className:"lineTitle"}),o.a.createElement(P,{name:"email",component:"input",placeholder:"enter email..."}),o.a.createElement(P,{name:"password",type:"password",component:"input",placeholder:"enter password..."})),o.a.createElement("button",{type:"submit"},"Login"),o.a.createElement(m.b,{to:"/sign",className:"link"},"Registration"))})),z=Object(u.b)((function(e){return{isLoading:e.authReducer.isLoading}}),{signInAuth:function(e){var t=e.username,a=e.email,n=e.password,r=e.setFieldError;return function(){var e=Object(x.a)(y.a.mark((function e(o){var i,s,c,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(v({isLoading:!0})),e.prev=1,i={user:{email:a,password:n,username:t}},e.next=5,V(i);case 5:return s=e.sent,e.next=8,s.data.user.token;case 8:return c=e.sent,e.next=11,s.data.user.username;case 11:return u=e.sent,e.next=14,o(w({isAuth:!0,token:c,name:u,isLoading:!1}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),o(L({isAuth:!1,isLoading:!1,error:e.t0,setFieldError:r}));case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()}})(H),M=Object(u.b)((function(e){return{name:e.authReducer.name,isLoading:e.authReducer.isLoading}}))((function(e){var t=e.isLoading,a=e.dispatch,n=e.name;return t?"Loading...":o.a.createElement("div",null,o.a.createElement("h2",null,"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f:",n),o.a.createElement("button",{onClick:function(){a(A({isAuth:!1,token:void 0,name:""}))}},"Logout"))})),Q=F.a().shape({username:F.b().max(50,"no more than 50 characters").required("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f"),email:F.b().email("Not correct email").required("Enter email"),password:F.b().required("Enter password").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,"Password between 8 and 40 characters, at least one number and one capital letter")}),Z=Object(U.d)({mapPropsToValues:function(){return{username:"",email:"",password:""}},validationSchema:function(){return Q},handleSubmit:function(e,t){var a=e.username,n=e.email,r=e.password,o=t.props,i=t.setFieldError;o.signInAuth({username:a,email:n,password:r,setFieldError:i})},displayName:"FormRegistration"})((function(e){var t=e.isLoading,a=e.handleSubmit;return t?"Loading...":o.a.createElement("form",{onSubmit:a,className:"form"},o.a.createElement("div",null,o.a.createElement("h2",{className:"title"},"Registration"),o.a.createElement("hr",{className:"lineTitle"}),o.a.createElement(P,{name:"username",component:"input",placeholder:"enter username..."}),o.a.createElement(P,{name:"email",component:"input",placeholder:"enter email..."}),o.a.createElement(P,{name:"password",type:"password",component:"input",placeholder:"enter password..."})),o.a.createElement("button",{type:"submit"},"Registration"),o.a.createElement(m.b,{to:"/login",className:"link"},"Login"))})),B=Object(u.b)((function(e){return{isLoading:e.authReducer.isLoading}}),{signInAuth:function(e){var t=e.username,a=e.email,n=e.password,r=e.setFieldError;return function(){var e=Object(x.a)(y.a.mark((function e(o){var i,s,c,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(g({isLoading:!0})),e.prev=1,i={user:{email:a,password:n,username:t}},e.next=5,J(i);case 5:return s=e.sent,e.next=8,s.data.user.token;case 8:return c=e.sent,e.next=11,s.data.user.username;case 11:return u=e.sent,e.next=14,o(O({isAuth:!0,token:c,name:u,isLoading:!1}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),o(j({isAuth:!1,isLoading:!1,error:e.t0,setFieldError:r}));case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()}})(Z),W=Object(u.b)((function(e){return{isAuth:e.authReducer.isAuth}}))((function(e){var t=e.component,a=e.isAuth,n=Object(I.a)(e,["component","isAuth"]);return o.a.createElement(R.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,e):o.a.createElement(R.a,{to:"/login"})}}))})),$=Object(u.b)((function(e){return{isAuth:e.authReducer.isAuth}}))((function(e){var t=e.component,a=e.isAuth,n=Object(I.a)(e,["component","isAuth"]);return o.a.createElement(R.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(R.a,{to:"/"}):o.a.createElement(t,e)}}))})),K=Object(u.b)((function(e){return{isAuth:e.authReducer.isAuth,token:e.authReducer.token}}))((function(e){var t=e.dispatch;return Object(r.useEffect)((function(){void 0!==localStorage.token&&t(w({isAuth:!0,token:localStorage.token,name:localStorage.name}))}),[t]),o.a.createElement("div",{className:"app"},o.a.createElement(R.d,null,o.a.createElement(W,{path:"/",exact:!0,component:M}),o.a.createElement($,{path:"/login",component:z}),o.a.createElement($,{path:"/sign",component:B}),o.a.createElement(R.a,{to:"/login"})))})),Y=Object(c.e)(N,Object(c.d)(Object(c.a)(l.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(u.a,{store:Y},o.a.createElement(m.a,null,o.a.createElement(K,null)))),document.getElementById("root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.47d7ba84.chunk.js.map