(this["webpackJsonpform-example-auth"]=this["webpackJsonpform-example-auth"]||[]).push([[0],{141:function(e,t,a){e.exports=a(221)},147:function(e,t,a){},221:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),i=a(25),s=a.n(i),c=(a(146),a(147),a(63)),u=a(10),l=a(120),m=a(24),d=a(45),p=a(31),h=a(225),E=a(226),b=Object(E.a)("USER_AUTHENTICARED_REQUEST"),g=Object(E.a)("USER_AUTHENTICARED_SUCCESS"),f=Object(E.a)("USER_AUTHENTICARED_FAILURE"),A=Object(E.a)("LOG_OUT_PROFILE"),O={name:"",token:void 0,isLoadingAuth:!1,isAuth:!1},w=Object(h.a)((n={},Object(d.a)(n,b,(function(e,t){var a=t.payload.isLoadingAuth;return Object(p.a)(Object(p.a)({},e),{},{isLoadingAuth:a})})),Object(d.a)(n,g,(function(e,t){var a=t.payload,n=a.isAuth,r=a.token,o=a.name;return Object(p.a)(Object(p.a)({},e),{},{isAuth:n,token:r,name:o})})),Object(d.a)(n,f,(function(e,t){var a=t.payload.isAuth;return Object(p.a)(Object(p.a)({},e),{},{isAuth:a})})),Object(d.a)(n,A,(function(e,t){var a=t.payload,n=a.isAuth,r=a.token,o=a.name;return localStorage.removeItem("token"),localStorage.removeItem("name"),Object(p.a)(Object(p.a)({},e),{},{name:o,isAuth:n,token:r})})),n),O);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var j=a(4),v=a(27),L=a(30),S=a(61),N=a(224),k=function(e){var t=e.name,a=Object(S.a)(e,["name"]);return o.a.createElement("div",{className:"formFieldWrap"},o.a.createElement(N.a,Object.assign({name:t},a,{className:"formField"})),o.a.createElement(v.a,{name:t,className:"formFieldError"},(function(e){return o.a.createElement("span",{className:"errorMsg"},e)})))},_=a(97),T=a.n(_),y=a(137),R=a(138),I=a.n(R),U=function(e){var t=e.username,a=e.email,n=e.password,r=e.setFieldError,o=e.URL;return function(){var e=Object(y.a)(T.a.mark((function e(i){var s,c,u,l,m,d,p;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(b({isLoadingAuth:!0})),e.prev=1,s={user:{email:a,password:n,username:t}},c={method:"POST",url:o,data:JSON.stringify(s),headers:{"Content-Type":"application/json;charset=utf-8"},json:!0},e.next=6,I()(c);case 6:return u=e.sent,e.next=9,u.data.user.token;case 9:return l=e.sent,e.next=12,u.data.user.username;case 12:return m=e.sent,e.next=15,i(g({isAuth:!0,token:l,name:m}));case 15:localStorage.setItem("token",l),localStorage.setItem("name",m),i(b({isLoadingAuth:!1})),e.next=26;break;case 20:for(p in e.prev=20,e.t0=e.catch(1),d=e.t0.response.data.errors)"email or password"===p.toString()?(r("email","email or password"),r("password","email or password")):r(p.toString(),d[p][0]);i(f({isAuth:!1})),i(b({isLoadingAuth:!1}));case 26:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}()},F=L.a().shape({email:L.b().email("Not correct email").required("Enter email"),password:L.b().required("Enter password").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,"Password between 8 and 40 characters, at least one number and one capital letter")}),x=Object(v.d)({mapPropsToValues:function(){return{email:"",password:""}},validationSchema:function(){return F},handleSubmit:function(e,t){var a=e.email,n=e.password,r=t.props,o=t.setFieldError;r.signInAuth({email:a,password:n,setFieldError:o,URL:"https://conduit.productionready.io/api/users/login"})},displayName:"FormAuth"})((function(e){var t=e.isLoadingAuth,a=e.handleSubmit;return t?"Loading...":o.a.createElement("form",{onSubmit:a,className:"form"},o.a.createElement("div",null,o.a.createElement("h2",{className:"title"},"Login"),o.a.createElement("hr",{className:"lineTitle"}),o.a.createElement(k,{name:"email",component:"input",placeholder:"enter email..."}),o.a.createElement(k,{name:"password",type:"password",component:"input",placeholder:"enter password..."})),o.a.createElement("button",{type:"submit"},"Login"),o.a.createElement(m.b,{to:"/sign",className:"link"},"Registration"))})),C=Object(u.b)((function(e){return{isLoadingAuth:e.isLoadingAuth}}),{signInAuth:U})(x),D=Object(u.b)((function(e){return{name:e.name,isLoadingAuth:e.isLoadingAuth}}))((function(e){var t=e.isLoadingAuth,a=e.dispatch,n=e.name;return t?"Loading...":o.a.createElement("div",null,o.a.createElement("h2",null,"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f:",n),o.a.createElement("button",{onClick:function(){a(A({isAuth:!1,token:void 0,name:""}))}},"Logout"))})),P=L.a().shape({username:L.b().max(50,"no more than 50 characters").required("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f"),email:L.b().email("Not correct email").required("Enter email"),password:L.b().required("Enter password").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,"Password between 8 and 40 characters, at least one number and one capital letter")}),q=Object(v.d)({mapPropsToValues:function(){return{username:"",email:"",password:""}},validationSchema:function(){return P},handleSubmit:function(e,t){var a=e.username,n=e.email,r=e.password,o=t.props,i=t.setFieldError;o.signInAuth({username:a,email:n,password:r,setFieldError:i,URL:"https://conduit.productionready.io/api/users/"})},displayName:"FormAuth"})((function(e){var t=e.isLoadingAuth,a=e.handleSubmit;return t?"Loading...":o.a.createElement("form",{onSubmit:a,className:"form"},o.a.createElement("div",null,o.a.createElement("h2",{className:"title"},"Registration"),o.a.createElement("hr",{className:"lineTitle"}),o.a.createElement(k,{name:"username",component:"input",placeholder:"enter username..."}),o.a.createElement(k,{name:"email",component:"input",placeholder:"enter email..."}),o.a.createElement(k,{name:"password",type:"password",component:"input",placeholder:"enter password..."})),o.a.createElement("button",{type:"submit"},"Registration"),o.a.createElement(m.b,{to:"/login",className:"link"},"Login"))})),z=Object(u.b)((function(e){return{isLoadingAuth:e.isLoadingAuth}}),{signInAuth:U})(q),V=Object(u.b)((function(e){return{isAuth:e.isAuth}}))((function(e){var t=e.component,a=e.isAuth,n=Object(S.a)(e,["component","isAuth"]);return o.a.createElement(j.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,e):o.a.createElement(j.a,{to:"/login"})}}))})),X=Object(u.b)((function(e){return{isAuth:e.isAuth}}))((function(e){var t=e.component,a=e.isAuth,n=Object(S.a)(e,["component","isAuth"]);return o.a.createElement(j.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(j.a,{to:"/"}):o.a.createElement(t,e)}}))})),Z=Object(u.b)((function(e){return{isLoadingAuth:e.isLoadingAuth,token:e.token}}))((function(e){var t=e.dispatch;return Object(r.useEffect)((function(){void 0!==localStorage.token&&t(g({isAuth:!0,token:localStorage.token,name:localStorage.name}))}),[t]),o.a.createElement("div",{className:"app"},o.a.createElement(j.d,null,o.a.createElement(V,{path:"/",exact:!0,component:D}),o.a.createElement(X,{path:"/login",component:C}),o.a.createElement(X,{path:"/sign",component:z}),o.a.createElement(j.a,{to:"/login"})))})),H=Object(c.d)(w,Object(c.c)(Object(c.a)(l.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(u.a,{store:H},o.a.createElement(m.a,null,o.a.createElement(Z,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[141,1,2]]]);
//# sourceMappingURL=main.b324e3de.chunk.js.map